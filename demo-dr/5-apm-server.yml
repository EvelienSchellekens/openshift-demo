apiVersion: apm.k8s.elastic.co/v1
kind: ApmServer
metadata:
  name: apm-server-quickstart
  namespace: demo-dr
spec:
  version: 8.8.0
  count: 1
  elasticsearchRef:
    name: "elasticsearch-quickstart"
  podTemplate:
    spec:
      serviceAccountName: elastic-agent
      automountServiceAccountToken: true
      securityContext:
        runAsUser: 0
      volumes:
      - name: apm-server-data
        emptyDir: {}
---
apiVersion: route.openshift.io/v1
kind: Route
metadata:
  name: apm-server-quickstart
  namespace: demo-dr
spec:
  #host: apm-server.example.com # override if you don't want to use the host that is automatically generated by OpenShift (<route-name>[-<namespace>].<suffix>)
  tls:
    termination: passthrough # the APM Server is the TLS endpoint
    insecureEdgeTerminationPolicy: Redirect
  to:
    kind: Service
    name: apm-server-quickstart-apm-http